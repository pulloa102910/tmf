<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Simulate Sea Level</title>
</head>
<body style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh;">
  <form id="simulateForm" onsubmit="sendSimulate(); return false;" style="display: flex; flex-direction: column; gap: 10px; width: 250px;">
    <input type="number" id="nivelInput" placeholder="Enter sea level (m)" step="0.1" required style="padding: 8px; font-size: 16px;" />
    
    <button type="submit" style="padding: 10px; background-color: #0078d4; color: white; border: none; border-radius: 5px; font-size: 16px; cursor: pointer;">
      Simulate Flood
    </button>

    <button type="button" onclick="clearMap();" style="padding: 10px; background-color: #d40000; color: white; border: none; border-radius: 5px; font-size: 16px; cursor: pointer;">
      Clear Map
    </button>
  </form>

  <script>
  function sendSimulate() {
    const nivel = document.getElementById('nivelInput').value;
    fetch('http://127.0.0.1:5000/simulate', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ nivel_mar: parseFloat(nivel) })
    })
    .then(response => {
      if (!response.ok) {
        throw new Error('Simulation request failed.');
      }
      return response.json();
    })
    .then(data => {
      alert('‚úÖ Simulation successful: ' + JSON.stringify(data));
      if (window.parent) {
        window.parent.postMessage({ type: 'REFRESH_LAYER' }, '*');
      }
    })
    .catch(error => {
      console.error('Error:', error);
      alert('‚ùå Error sending simulation: ' + error.message);
    });
  }

  function clearMap() {
    fetch('http://127.0.0.1:5000/clear', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' }
    })
    .then(response => {
      if (!response.ok) {
        throw new Error('Clear request failed.');
      }
      return response.json();
    })
    .then(data => {
      alert('üßπ Map cleared: ' + JSON.stringify(data));
      if (window.parent) {
        window.parent.postMessage({ type: 'REFRESH_LAYER' }, '*');
      }
    })
    .catch(error => {
      console.error('Error:', error);
      alert('‚ùå Error clearing map: ' + error.message);
    });
  }
  </script>
</body>
</html>
